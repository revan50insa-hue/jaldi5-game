<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Jaldi 5</title>

<!-- Firebase v8 SDK -->
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

<style>
body {margin:0;font-family:Arial,sans-serif;background:linear-gradient(135deg,#1a1a2e,#16213e);color:white;height:100vh;}
.header {text-align:center;padding:20px;font-size:28px;font-weight:bold;background:#0f3460;}
.container {display:flex;flex-direction:column;align-items:center;margin-top:40px;}
.card {width:85%;background:#222831;border-radius:15px;padding:20px;margin:15px;box-shadow:0 10px 20px rgba(0,0,0,0.5);}
.card h2 {margin-top:0;}
input {width:90%;padding:12px;margin-top:10px;border-radius:8px;border:none;font-size:16px;}
button {margin-top:15px;padding:12px 25px;border:none;border-radius:8px;background:#00adb5;color:white;font-size:16px;cursor:pointer;}
button:hover {background:#028a90;}
.hidden {display:none;}
.lobby {text-align:center;padding:30px;}
.lobby #playerList {margin-top:20px;}
</style>
</head>
<body>

<!-- HOME PAGE -->
<div id="homePage">
<div class='header'>ðŸŽ¯ JALDI 5</div>
<div class='container'>

<div class='card'>
<h2>Create Group</h2>
<p>Create a new game and invite friends</p>
<button onclick='createGroup()'>Create Group</button>
</div>

<div class='card'>
<h2>Join Group</h2>
<p>Enter Group ID to join</p>
<input id='groupInput' placeholder='Enter Group ID'>
<button onclick='joinGroup()'>Join Group</button>
</div>

</div>
</div>

<!-- LOBBY PAGE -->
<div id='lobbyPage' class='hidden'>
<div class='header'>ðŸŽ® Game Lobby</div>
<div class='lobby'>
<h2>Group ID: <span id='groupIdText'></span></h2>
<div id='playerList'></div>
<button onclick='goHome()'>Back to Home</button>
</div>
</div>

<script>
// ---------- Firebase Setup ----------
var firebaseConfig = {
  apiKey: "YOUR_WEB_API_KEY",
  authDomain: "YOUR_PROJECT.firebaseapp.com",
  databaseURL: "https://YOUR_PROJECT-default-rtdb.firebaseio.com",
  projectId: "YOUR_PROJECT",
  storageBucket: "YOUR_PROJECT.appspot.com",
  messagingSenderId: "YOUR_SENDER_ID",
  appId: "YOUR_APP_ID"
};
firebase.initializeApp(firebaseConfig);
var db = firebase.database();

// ---------- Player ID ----------
var playerId = 'PLR_'+Math.floor(Math.random()*1000000);
console.log("My Player ID:", playerId);

// ---------- Functions ----------
function createGroup() {
  var groupId = 'GRP-'+Math.floor(100000 + Math.random()*900000);
  console.log("Creating group:", groupId);

  db.ref('groups/'+groupId).set({
    creator: playerId,
    players: {}
  }, function(error) {
    if(error){
      alert("Failed to create group!");
    } else {
      joinFirebaseGroup(groupId); // go to lobby automatically
    }
  });
}

function joinGroup() {
  var groupId = document.getElementById('groupInput').value.trim();
  if(groupId===''){ alert("Enter Group ID"); return; }
  joinFirebaseGroup(groupId);
}

function joinFirebaseGroup(groupId) {
  // Show lobby page
  document.getElementById('homePage').classList.add('hidden');
  document.getElementById('lobbyPage').classList.remove('hidden');
  document.getElementById('groupIdText').innerText = groupId;

  // Add player to Firebase
  db.ref('groups/'+groupId+'/players/'+playerId).set(true);

  // Listen for live player list
  db.ref('groups/'+groupId+'/players').on('value', function(snapshot){
    var players = snapshot.val();
    var html = "<h3>Players:</h3><ul>";
    for(var p in players){ html += "<li>"+p+"</li>"; }
    html += "</ul>";
    document.getElementById('playerList').innerHTML = html;
  });
}

function goHome() {
  document.getElementById('lobbyPage').classList.add('hidden');
  document.getElementById('homePage').classList.remove('hidden');
}
</script>

</body>
</html>
