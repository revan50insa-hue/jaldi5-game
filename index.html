<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Jaldi 5</title>
<style>
  body { font-family: Arial; background:#111; color:#fff; text-align:center; padding:40px; }
  button { padding:12px 20px; margin:10px; font-size:16px; border:none; border-radius:6px; cursor:pointer; }
  input { padding:10px; font-size:16px; border-radius:6px; border:none; width:200px; margin:5px; }
  #myid { margin-top:20px; font-size:20px; }
  #groupInfo { margin-top:20px; font-size:18px; }
</style>

<!-- Firebase SDKs for browser -->
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.23.0/firebase-database-compat.js"></script>

<script>
  // Firebase config (replace with yours)
  const firebaseConfig = {
    apiKey: "AIzaSyCeg-D---KoJEtVcBN5iwFs9WDHBRIgZjA",
    authDomain: "tffhacksv4.firebaseapp.com",
    databaseURL: "https://tffhacksv4-default-rtdb.firebaseio.com",
    projectId: "tffhacksv4",
    storageBucket: "tffhacksv4.firebasestorage.app",
    messagingSenderId: "641197191429",
    appId: "1:641197191429:web:7b63ca534dd41e19d8476c",
    measurementId: "G-X394XS64RN"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const database = firebase.database();
</script>

</head>
<body>

<h2>Jaldi 5</h2>
<div id="myid">Loading ID...</div>

<button id="createGroupBtn">Create Group</button>

<div id="groupSection" style="margin-top:30px;">
  <input type="text" id="joinGroupId" placeholder="Enter Group ID to join">
  <button id="joinGroupBtn">Join Group</button>
</div>

<div id="groupInfo"></div>

<script>
  // 1️⃣ Generate Player ID
  let myId = localStorage.getItem("player_id");
  if(!myId){
    myId = "PLR_" + Math.floor(100000 + Math.random()*900000);
    localStorage.setItem("player_id", myId);
  }
  document.getElementById("myid").innerText = "My ID: " + myId;

  // 2️⃣ Create Group
  document.getElementById("createGroupBtn").addEventListener("click", function(){
    let groupId = "GROUP_" + Math.floor(1000 + Math.random()*9000);
    database.ref("groups/" + groupId + "/players/" + myId).set({
      joinedAt: Date.now()
    });
    document.getElementById("groupInfo").innerText = "Group created! Share this ID with friends: " + groupId;
  });

  // 3️⃣ Join Group
  document.getElementById("joinGroupBtn").addEventListener("click", function(){
    let groupId = document.getElementById("joinGroupId").value.trim();
    if(groupId.length === 0){
      alert("Enter a valid Group ID");
      return;
    }
    // Save player to Firebase group
    database.ref("groups/" + groupId + "/players/" + myId).set({
      joinedAt: Date.now()
    }, function(error){
      if(error){
        alert("Failed to join group");
      } else {
        document.getElementById("groupInfo").innerText = "Joined Group: " + groupId;
      }
    });
  });
</script>

</body>
</html>
